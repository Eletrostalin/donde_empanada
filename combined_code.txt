
# Code from /Users/nickstanchenkov/donde_empanada4/donde_empanada4/run.py
import os
import logging
import asyncio

from sqlalchemy.ext.asyncio import create_async_engine, AsyncSession
from sqlalchemy.orm import sessionmaker
from sqlalchemy.future import select
from sqlalchemy import text
from app import create_app
from app.models import db, Migration

app = create_app()

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(level=logging.INFO)
logger = logging.getLogger(__name__)

# –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –¥–≤–∏–∂–æ–∫ SQLAlchemy —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –¥—Ä–∞–π–≤–µ—Ä–∞ asyncpg
DATABASE_URL = os.getenv('DATABASE_URL').replace("psycopg2", "asyncpg")
async_engine = create_async_engine(DATABASE_URL, echo=True)
async_session = sessionmaker(
    bind=async_engine,
    expire_on_commit=False,
    class_=AsyncSession
)

async def check_any_table_exists() -> bool:
    """
    –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —Å—É—â–µ—Å—Ç–≤—É—é—Ç –ª–∏ –∫–∞–∫–∏–µ-–ª–∏–±–æ —Ç–∞–±–ª–∏—Ü—ã –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç True, –µ—Å–ª–∏ —Ç–∞–±–ª–∏—Ü—ã —Å—É—â–µ—Å—Ç–≤—É—é—Ç, –∏–Ω–∞—á–µ False.
    """
    async with async_session() as session:
        async with session.begin():
            result = await session.execute(
                text("SELECT EXISTS (SELECT 1 FROM information_schema.tables WHERE table_schema = 'public');")
            )
            return result.scalar()

async def apply_migrations():
    """
    –ü—Ä–∏–º–µ–Ω—è–µ—Ç –Ω–æ–≤—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –∏–∑ –ø–∞–ø–∫–∏ migrations –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö, –∏—Å–ø–æ–ª—å–∑—É—è SQLAlchemy.
    """
    migrations_folder = 'migrations'

    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –ª—é–±—ã—Ö —Ç–∞–±–ª–∏—Ü –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
    tables_exist = await check_any_table_exists()

    async with async_session() as session:
        if tables_exist:
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ —Ç–∞–±–ª–∏—Ü–∞ migrations
            result = await session.execute(
                text("SELECT EXISTS (SELECT 1 FROM information_schema.tables WHERE table_name = 'migration');")
            )
            migrations_table_exists = result.scalar()

            if migrations_table_exists:
                # –ü–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ –ø—Ä–∏–º–µ–Ω—ë–Ω–Ω—ã—Ö –º–∏–≥—Ä–∞—Ü–∏–π –∏–∑ —Ç–∞–±–ª–∏—Ü—ã migration
                result = await session.execute(select(Migration.migration_name))
                applied_migrations = set(row[0] for row in result.all())
            else:
                applied_migrations = set()
                logging.info("–¢–∞–±–ª–∏—Ü–∞ 'migration' –Ω–µ –Ω–∞–π–¥–µ–Ω–∞. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –º–∏–≥—Ä–∞—Ü–∏–π.")
        else:
            applied_migrations = set()
            logging.info("–¢–∞–±–ª–∏—Ü—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –º–∏–≥—Ä–∞—Ü–∏–π.")

        # –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –≤—Å–µ—Ö SQL —Ñ–∞–π–ª–æ–≤ –≤ –ø–∞–ø–∫–µ –º–∏–≥—Ä–∞—Ü–∏–π
        all_migrations = [f for f in os.listdir(migrations_folder) if f.endswith('.sql')]

        # –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤—ã—Ö –º–∏–≥—Ä–∞—Ü–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –µ—â—ë –Ω–µ –±—ã–ª–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã
        new_migrations = [m for m in all_migrations if m not in applied_migrations]

        # –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –º–∏–≥—Ä–∞—Ü–∏–π –ø–æ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞ –¥–ª—è –∏—Ö –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –≤ –ø–æ—Ä—è–¥–∫–µ
        new_migrations.sort()

        if new_migrations:
            logging.info(f"–ù–∞–π–¥–µ–Ω–æ {len(new_migrations)} –Ω–æ–≤—ã—Ö –º–∏–≥—Ä–∞—Ü–∏–π: {new_migrations}")

            async with async_engine.connect() as conn:  # –ò—Å–ø–æ–ª—å–∑—É–µ–º async_engine –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
                async with conn.begin():  # –ù–∞—á–∞–ª–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
                    try:
                        for migration in new_migrations:
                            migration_file_path = os.path.join(migrations_folder, migration)

                            # –û—Ç–∫—Ä—ã—Ç–∏–µ —Ñ–∞–π–ª–∞ –º–∏–≥—Ä–∞—Ü–∏–∏ –∏ —á—Ç–µ–Ω–∏–µ SQL –∫–æ–º–∞–Ω–¥
                            with open(migration_file_path, 'r', encoding='utf-8') as migration_file:
                                sql_commands = migration_file.read()

                            # –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥ –ø–æ ';' –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–∞–∂–¥–æ–π –∫–æ–º–∞–Ω–¥—ã –æ—Ç–¥–µ–ª—å–Ω–æ
                            for command in sql_commands.split(';'):
                                command = command.strip()
                                if command:  # –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏
                                    logging.info(f"–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ SQL –∫–æ–º–∞–Ω–¥—ã:\n{command}")
                                    await conn.execute(text(command))  # –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ SQL –∫–æ–º–∞–Ω–¥—ã

                        await conn.commit()

                        # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö –∫–æ–º–∞–Ω–¥
                        for migration in new_migrations:
                            new_migration = Migration(migration_name=migration)
                            session.add(new_migration)
                        await session.commit()
                        logging.info(f"–ú–∏–≥—Ä–∞—Ü–∏–∏ {new_migrations} —É—Å–ø–µ—à–Ω–æ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã.")

                    except Exception as e:
                        logging.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–∏ –º–∏–≥—Ä–∞—Ü–∏–∏: {e}")
                        await conn.rollback()  # –û—Ç–∫–∞—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ø—Ä–∏ –æ—à–∏–±–∫–µ
                    else:
                        await conn.commit()  # –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
        else:
            logging.info("–ù–æ–≤—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç.")


def main():
    """
    –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
    """
    with app.app_context():
        asyncio.run(apply_migrations())  # –ü—Ä–∏–º–µ–Ω—è–µ–º –º–∏–≥—Ä–∞—Ü–∏–∏
    app.run(debug=True)

if __name__ == '__main__':
    main()

# End of code from /Users/nickstanchenkov/donde_empanada4/donde_empanada4/run.py

# Code from /Users/nickstanchenkov/donde_empanada4/donde_empanada4/config.py
import os
from dotenv import load_dotenv

load_dotenv()

class Config:
    SECRET_KEY = os.getenv('SECRET_KEY', 'you-will-never-guess')
    SQLALCHEMY_DATABASE_URI = os.getenv('DATABASE_URL')
    SQLALCHEMY_TRACK_MODIFICATIONS = False
    GOOGLE_MAPS_API_KEY = os.getenv('GOOGLE_MAPS_API_KEY')
# End of code from /Users/nickstanchenkov/donde_empanada4/donde_empanada4/config.py

# Code from /Users/nickstanchenkov/donde_empanada4/donde_empanada4/—Ä—É–¥–∑—É–∫.py
import os

def gather_code_from_directory(directory, output_file, ignore_dirs=None):
    if ignore_dirs is None:
        ignore_dirs = {'.venv', 'migrations'}

    with open(output_file, 'w', encoding='utf-8') as outfile:
        for root, dirs, files in os.walk(directory):
            # –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º —É–∫–∞–∑–∞–Ω–Ω—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
            dirs[:] = [d for d in dirs if d not in ignore_dirs]
            for file in files:
                if file.endswith(('.py', '.html', '.css')):
                    file_path = os.path.join(root, file)
                    with open(file_path, 'r', encoding='utf-8') as infile:
                        outfile.write(f"\n# Code from {file_path}\n")
                        outfile.write(infile.read())
                        outfile.write(f"\n# End of code from {file_path}\n")

if __name__ == "__main__":
    project_directory = os.getcwd()  # –¢–µ–∫—É—â–∞—è —Ä–∞–±–æ—á–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è
    output_file_path = "combined_code.txt"  # –ò–º—è –≤—ã—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞

    gather_code_from_directory(project_directory, output_file_path)
    print(f"Code from all .py, .html, and .css files in {project_directory} has been combined into {output_file_path}")

# End of code from /Users/nickstanchenkov/donde_empanada4/donde_empanada4/—Ä—É–¥–∑—É–∫.py

# Code from /Users/nickstanchenkov/donde_empanada4/donde_empanada4/app/models.py
# models.py

from datetime import datetime
from . import db
from werkzeug.security import generate_password_hash, check_password_hash
from flask_login import UserMixin

class User(db.Model, UserMixin):
    id = db.Column(db.Integer, primary_key=True)
    username = db.Column(db.String(150), unique=True, nullable=False)
    email = db.Column(db.String(150), nullable=True)
    password_hash = db.Column(db.String(256), nullable=False)
    first_name = db.Column(db.String(150), nullable=False)
    second_name = db.Column(db.String(150), nullable=False)
    phone_hash = db.Column(db.String(256), unique=True, nullable=False)

    def set_password(self, password):
        self.password_hash = generate_password_hash(password)

    def check_password(self, password):
        return check_password_hash(self.password_hash, password)

    def set_phone(self, phone):
        self.phone_hash = generate_password_hash(phone)

    def check_phone(self, phone):
        return check_password_hash(self.phone_hash, phone)

class Location(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    name = db.Column(db.String(150), nullable=False)
    description = db.Column(db.Text, nullable=False)
    latitude = db.Column(db.Float, nullable=False)
    longitude = db.Column(db.Float, nullable=False)
    average_rating = db.Column(db.Float, default=0, nullable=False)
    rating_count = db.Column(db.Integer, default=0)
    created_by = db.Column(db.Integer, db.ForeignKey('user.id'), nullable=False)
    created_at = db.Column(db.DateTime, default=db.func.current_timestamp())
    address = db.Column(db.String(255), nullable=True)
    working_hours = db.Column(db.String(255), nullable=True)
    average_check = db.Column(db.Integer, nullable=True)

    reviews = db.relationship('Review', backref='location', lazy=True)
    owner_info = db.relationship('OwnerInfo', backref='location', uselist=False)  # –°–≤—è–∑—å —Å OwnerInfo

class Review(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    user_id = db.Column(db.Integer, db.ForeignKey('user.id'), nullable=False)
    location_id = db.Column(db.Integer, db.ForeignKey('location.id'), nullable=False)
    rating = db.Column(db.Integer, nullable=False)
    comment = db.Column(db.Text, nullable=False)
    created_at = db.Column(db.DateTime, default=datetime.utcnow)

    user = db.relationship('User', backref='reviews', lazy=True)

    def __repr__(self):
        return f'<Review {self.rating}>'

class OwnerInfo(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    user_id = db.Column(db.Integer, db.ForeignKey('user.id'), nullable=False)
    location_id = db.Column(db.Integer, db.ForeignKey('location.id'), nullable=False)
    website = db.Column(db.String(200), nullable=True)
    owner_info = db.Column(db.Text, nullable=False)

    user = db.relationship('User', backref='owner_info', lazy=True)

class Migration(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    migration_name = db.Column(db.String(255), nullable=False, unique=True)
    applied_at = db.Column(db.DateTime, default=datetime.utcnow)

    def __repr__(self):
        return f'<Migration {self.migration_name} applied at {self.applied_at}>'

    def __repr__(self):
        return f'<OwnerInfo {self.id}>'

# End of code from /Users/nickstanchenkov/donde_empanada4/donde_empanada4/app/models.py

# Code from /Users/nickstanchenkov/donde_empanada4/donde_empanada4/app/__init__.py
from flask import Flask
from flask_sqlalchemy import SQLAlchemy

from flask_login import LoginManager
from flask_wtf.csrf import CSRFProtect
import logging
from logging import StreamHandler
import sys

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π
db = SQLAlchemy()
login_manager = LoginManager()
csrf = CSRFProtect()

def create_app():
    app = Flask(__name__)
    app.config.from_object('config.Config')

    # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
    stream_handler = StreamHandler(sys.stdout)
    stream_handler.setLevel(logging.DEBUG)
    app.logger.addHandler(stream_handler)
    app.logger.setLevel(logging.DEBUG)

    # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è Alembic
    alembic_logger = logging.getLogger('alembic')
    alembic_logger.addHandler(stream_handler)
    alembic_logger.setLevel(logging.INFO)

    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π
    db.init_app(app)
    login_manager.init_app(app)
    csrf.init_app(app)

    with app.app_context():
        from . import models
        from .models import User

        @login_manager.user_loader
        def load_user(user_id):
            return User.query.get(int(user_id))

    from . import routes
    app.register_blueprint(routes.bp)

    return app

# End of code from /Users/nickstanchenkov/donde_empanada4/donde_empanada4/app/__init__.py

# Code from /Users/nickstanchenkov/donde_empanada4/donde_empanada4/app/forms.py
from flask_wtf import FlaskForm
from wtforms import StringField, PasswordField, SubmitField, IntegerField, TextAreaField
from wtforms.validators import DataRequired, Email, EqualTo, Length, ValidationError, Optional, NumberRange
import re

def validate_username(form, field):
    if not re.match(r'^[a-zA-Z]+$', field.data):  # –¢–æ–ª—å–∫–æ –±—É–∫–≤—ã
        raise ValidationError('–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ç–æ–ª—å–∫–æ –±—É–∫–≤—ã.')

def validate_name(form, field):
    if not re.match(r'^[a-zA-Z]+$', field.data):
        raise ValidationError('–≠—Ç–æ –ø–æ–ª–µ –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ç–æ–ª—å–∫–æ –±—É–∫–≤—ã.')

def validate_phone(form, field):
    if not re.match(r'^[0-9]+$', field.data):
        raise ValidationError('–¢–µ–ª–µ—Ñ–æ–Ω –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ç–æ–ª—å–∫–æ —Ü–∏—Ñ—Ä—ã.')

# –ù–æ–≤—ã–π –≤–∞–ª–∏–¥–∞—Ç–æ—Ä –¥–ª—è —á–∞—Å–æ–≤ —Ä–∞–±–æ—Ç—ã
def validate_working_hours(form, field):
    if not re.match(r'^\d{2}:\d{2} - \d{2}:\d{2}$', field.data):
        raise ValidationError('–í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤ —Ñ–æ—Ä–º–∞—Ç–µ xx:xx - xx:xx.')

class RegistrationForm(FlaskForm):
    username = StringField('Username', validators=[DataRequired(message="–ü–æ–ª–µ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º"), validate_username])
    email = StringField('Email', validators=[Optional(), Email(message="–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç email")])
    password = PasswordField('Password', validators=[
        DataRequired(message="–ü–æ–ª–µ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º"),
        Length(min=8, message="–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–æ–≤"),
        lambda form, field: re.match(r'^(?=.*[a-z])(?=.*\d).+$', field.data) or ValidationError(
            "–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ü–∏—Ñ—Ä—ã –∏ —Å—Ç—Ä–æ—á–Ω—ã–µ –±—É–∫–≤—ã"
        )
    ])
    confirm_password = PasswordField('Confirm Password', validators=[
        DataRequired(message="–ü–æ–ª–µ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º"),
        EqualTo('password', message="–ü–∞—Ä–æ–ª–∏ –¥–æ–ª–∂–Ω—ã —Å–æ–≤–ø–∞–¥–∞—Ç—å")
    ])
    first_name = StringField('First Name', validators=[DataRequired(message="–ü–æ–ª–µ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º"), validate_name])
    second_name = StringField('Second Name', validators=[DataRequired(message="–ü–æ–ª–µ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º"), validate_name])
    phone = StringField('Phone', validators=[DataRequired(message="–ü–æ–ª–µ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º"), validate_phone])
    submit = SubmitField('Register')

class LoginForm(FlaskForm):
    username = StringField('Username', validators=[DataRequired()])
    password = PasswordField('Password', validators=[DataRequired()])
    submit = SubmitField('Login')

class LocationForm(FlaskForm):
    name = StringField('Name', validators=[DataRequired()])
    description = TextAreaField('Description', validators=[DataRequired()])
    address = StringField('Address', validators=[DataRequired()])
    working_hours = StringField('Working Hours', validators=[DataRequired(), validate_working_hours])
    average_check = IntegerField('Average Check', validators=[DataRequired(), NumberRange(min=2000, max=5000)])  # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥–∏–∞–ø–∞–∑–æ–Ω–∞
    submit_add = SubmitField('–î–æ–±–∞–≤–∏—Ç—å')  # –ö–Ω–æ–ø–∫–∞ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è
    submit_cancel = SubmitField('–û—Ç–º–µ–Ω–∞')  # –ö–Ω–æ–ø–∫–∞ –¥–ª—è –æ—Ç–º–µ–Ω—ã
    submit_owner = SubmitField('–Ø —Ö–æ–∑—è–∏–Ω')  # –ö–Ω–æ–ø–∫–∞ –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –¥–æ–ø. —Ñ–æ—Ä–º—ã

class ReviewForm(FlaskForm):
    rating = IntegerField('Rating', validators=[DataRequired()])
    comment = TextAreaField('Comment', validators=[DataRequired()])
    submit = SubmitField('Add Review')

class OwnerInfoForm(FlaskForm):
    website = StringField('Website', validators=[Optional(), Length(max=200), Email(message='–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π URL')])
    owner_info = TextAreaField('Info About You and Your Establishment', validators=[DataRequired(), Length(max=500)])
    submit = SubmitField('–û—Ç–ø—Ä–∞–≤–∏—Ç—å')  # –ö–Ω–æ–ø–∫–∞ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

# End of code from /Users/nickstanchenkov/donde_empanada4/donde_empanada4/app/forms.py

# Code from /Users/nickstanchenkov/donde_empanada4/donde_empanada4/app/routes.py
# routes.py

from flask import Blueprint, render_template, redirect, url_for, flash, request, jsonify, current_app as app
from flask_login import login_user, logout_user, current_user, login_required
from .models import db, User, Location, Review, OwnerInfo
from .forms import RegistrationForm, LoginForm, LocationForm, OwnerInfoForm
import logging
import os

bp = Blueprint('main', __name__)

@bp.route('/')
def index():
    app.logger.info('–ó–∞–≥—Ä—É–∑–∫–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã')
    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö —Ñ–æ—Ä–º
    registration_form = RegistrationForm()
    login_form = LoginForm()
    location_form = LocationForm()
    owner_info_form = OwnerInfoForm()
    google_maps_api_key = os.getenv('GOOGLE_MAPS_API_KEY')

    # –ü–µ—Ä–µ–¥–∞—á–∞ –≤—Å–µ—Ö —Ñ–æ—Ä–º –≤ —à–∞–±–ª–æ–Ω
    return render_template('index.html',
                           registration_form=registration_form,
                           login_form=login_form,
                           location_form=location_form,
                           owner_info_form=owner_info_form,
                           google_maps_api_key=google_maps_api_key)
@bp.route('/register', methods=['POST'])
def register():
    form = RegistrationForm()
    if form.validate_on_submit():
        existing_user_by_username = User.query.filter_by(username=form.username.data).first()
        existing_user_by_phone = User.query.filter_by(phone_hash=form.phone.data).first()

        if existing_user_by_username:
            message = '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º –∏–º–µ–Ω–µ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç. üö´'
            return jsonify(success=False, message=message)

        if existing_user_by_phone:
            message = '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º —Ç–µ–ª–µ—Ñ–æ–Ω–æ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç. üö´'
            return jsonify(success=False, message=message)

        user = User(
            username=form.username.data,
            email=form.email.data,
            first_name=form.first_name.data,
            second_name=form.second_name.data,
        )
        user.set_password(form.password.data)
        user.set_phone(form.phone.data)
        db.session.add(user)
        db.session.commit()
        message = '–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ! üòä'
        return jsonify(success=True, message=message)
    else:
        error_messages = [f"{field}: {', '.join(errors)}" for field, errors in form.errors.items()]
        message = f'–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏: {", ".join(error_messages)} üö´'
        return jsonify(success=False, message=message)

@bp.route('/login', methods=['POST'])
def login():
    form = LoginForm()
    if form.validate_on_submit():
        user = User.query.filter_by(username=form.username.data).first()
        if user and user.check_password(form.password.data):
            login_user(user)
            message = '–í—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ! üòä'
            flash(message, 'success')
            app.logger.info(message)
            return jsonify(success=True, message=message)
        else:
            message = '–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –ø–∞—Ä–æ–ª—å. üö´'
            flash(message, 'danger')
            app.logger.warning(message)
            return jsonify(success=False, message=message)
    else:
        error_messages = [f"{field}: {', '.join(errors)}" for field, errors in form.errors.items()]
        message = f'–û—à–∏–±–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ñ–æ—Ä–º—ã: {", ".join(error_messages)} üö´'
        flash(message, 'danger')
        app.logger.error(f'–û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ñ–æ—Ä–º—ã: {form.errors}')
        return jsonify(success=False, message=message)

@bp.route('/logout')
@login_required
def logout():
    logout_user()
    message = '–í—ã —É—Å–ø–µ—à–Ω–æ –≤—ã—à–ª–∏ –∏–∑ —Å–∏—Å—Ç–µ–º—ã! üòä'
    flash(message, 'success')
    app.logger.info(message)
    return redirect(url_for('main.index'))

@bp.route('/add_location', methods=['POST'])
@login_required
def add_location():
    app.logger.debug('–ü–æ–ª—É—á–µ–Ω –∑–∞–ø—Ä–æ—Å –Ω–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–µ—Ç–∫–∏')
    form = LocationForm()
    if form.validate_on_submit():
        app.logger.debug('–§–æ—Ä–º–∞ –ø—Ä–æ—à–ª–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—é')
        try:
            latitude = float(request.form['latitude'])
            longitude = float(request.form['longitude'])
            app.logger.debug('–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã: %s, %s', latitude, longitude)
            new_location = Location(
                name=form.name.data,
                description=form.description.data,
                address=form.address.data,
                working_hours=form.working_hours.data,
                average_check=form.average_check.data,
                latitude=latitude,
                longitude=longitude,
                created_by=current_user.id
            )
            db.session.add(new_location)
            db.session.commit()
            message = '–ú–µ—Ç–∫–∞ —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö! üòä'
            app.logger.info(message)
            return jsonify(success=True, message=message)
        except Exception as e:
            message = f'–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –º–µ—Ç–∫–∏: {e} üö´'
            app.logger.error(message)
            return jsonify(success=False, message=message)
    else:
        error_messages = [f"{field}: {', '.join(errors)}" for field, errors in form.errors.items()]
        message = f'–û—à–∏–±–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ñ–æ—Ä–º—ã: {", ".join(error_messages)} üö´'
        app.logger.error(f'–û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ñ–æ—Ä–º—ã: {form.errors}')
        return jsonify(success=False, message=message)

@bp.route('/add_owner_info', methods=['POST'])
@login_required
def add_owner_info():
    form = OwnerInfoForm()
    if form.validate_on_submit():
        try:
            location_id = request.form['location_id']
            new_owner_info = OwnerInfo(
                user_id=current_user.id,
                location_id=location_id,
                website=form.website.data,
                owner_info=form.owner_info.data
            )
            db.session.add(new_owner_info)
            db.session.commit()
            message = '–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤–ª–∞–¥–µ–ª—å—Ü–µ —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö! üòä'
            app.logger.info(message)
            return jsonify(success=True, message=message)
        except Exception as e:
            message = f'–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏: {e} üö´'
            app.logger.error(message)
            return jsonify(success=False, message=message)
    else:
        error_messages = [f"{field}: {', '.join(errors)}" for field, errors in form.errors.items()]
        message = f'–û—à–∏–±–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ñ–æ—Ä–º—ã: {", ".join(error_messages)} üö´'
        app.logger.error(f'–û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ñ–æ—Ä–º—ã: {form.errors}')
        return jsonify(success=False, message=message)

@bp.route('/markers')
def markers():
    locations = Location.query.all()
    markers = []
    for location in locations:
        markers.append({
            'id': location.id,
            'name': location.name,
            'description': location.description,
            'latitude': location.latitude,
            'longitude': location.longitude,
            'address': location.address,
            'working_hours': location.working_hours,
            'average_check': location.average_check,
            'average_rating': location.average_rating,
            'rating_count': location.rating_count
        })
    app.logger.info('–°–ø–∏—Å–æ–∫ –º–µ—Ç–æ–∫ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω')
    return jsonify(markers)

@bp.route('/reviews/<int:location_id>')
def reviews(location_id):
    reviews = Review.query.filter_by(location_id=location_id).all()
    reviews_list = [
        {
            'user_name': review.user.username,
            'comment': review.comment,
            'rating': review.rating
        } for review in reviews
    ]
    return jsonify(reviews_list)

@bp.route('/add_review', methods=['POST'])
@login_required
def add_review():
    try:
        location_id = request.form['location_id']
        rating = int(request.form['rating'])
        comment = request.form['comment']

        new_review = Review(
            user_id=current_user.id,
            location_id=location_id,
            rating=rating,
            comment=comment
        )
        db.session.add(new_review)
        db.session.commit()

        location = Location.query.get(location_id)
        reviews = Review.query.filter_by(location_id=location_id).all()
        total_ratings = sum([review.rating for review in reviews])
        location.rating_count = len(reviews)
        location.average_rating = total_ratings / location.rating_count if location.rating_count else 0
        db.session.commit()

        return jsonify(success=True, message='–û—Ç–∑—ã–≤ —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω!')
    except Exception as e:
        app.logger.error(f'–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –æ—Ç–∑—ã–≤–∞: {e}')
        return jsonify(success=False, message=f'–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –æ—Ç–∑—ã–≤–∞: {e}')

# End of code from /Users/nickstanchenkov/donde_empanada4/donde_empanada4/app/routes.py

# Code from /Users/nickstanchenkov/donde_empanada4/donde_empanada4/app/static/styles.css
/* –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–æ–Ω —Å—Ç—Ä–∞–Ω–∏—Ü—ã */
body, html {
    height: 100%;
    margin: 0;
    font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
    background-color: #f4f4f9;
    font-size: 14px; /* –£–º–µ–Ω—å—à–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ —à—Ä–∏—Ñ—Ç–∞ */
}

/* –°—Ç–∏–ª–∏ –¥–ª—è –∫–∞—Ä—Ç—ã */
#map {
    height: 100%;
}

/* –®–∞–ø–∫–∞ */
.header {
    position: absolute;
    top: 30px;
    left: 30px;
    right: 30px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: #ffffff;
    z-index: 2;
    border-radius: 24px;
    padding: 0 20px;
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12);
}

.header img {
    height: 50px;
    cursor: pointer;
}

.login-button {
    cursor: pointer;
    color: #dd362f; /* rgb(221, 54, 47) */
}

.login-button:hover {
    color: #fca711; /* rgb(252, 167, 17) */
}

.link {
    cursor: pointer;
    color: #dd362f; /* rgb(221, 54, 47) */
}

.link:hover {
    color: #fca711; /* rgb(252, 167, 17) */
}

.custom-button-right {
    position: absolute;
    top: 100px;
    right: 50px;
    z-index: 2;
}

.custom-button-right img {
    width: 40px; /* —É–º–µ–Ω—å—à–µ–Ω–æ –Ω–∞ 20% */
    height: 40px; /* —É–º–µ–Ω—å—à–µ–Ω–æ –Ω–∞ 20% */
    cursor: pointer;
    border-radius: 12px; /* —Å–∫—Ä—É–≥–ª–µ–Ω–∏–µ —É–≥–ª–æ–≤ */
}

.modal {
    display: none;
    position: fixed;
    z-index: 3;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    overflow: auto;
    background-color: rgba(0, 0, 0, 0.4);
}

.modal-content {
    background-color: #ffffff;
    margin: auto;
    padding: 18px; /* –£–º–µ–Ω—å—à–µ–Ω–∏–µ padding */
    border: 1px solid #888;
    width: 30%; /* –®–∏—Ä–∏–Ω–∞ 30% —ç–∫—Ä–∞–Ω–∞ */
    border-radius: 10px;
    position: relative;
    top: 50%;
    transform: translateY(-50%);

}

.modal-content .form-group {
    margin-bottom: 8px; /* –£–º–µ–Ω—å—à–µ–Ω–∏–µ –æ—Ç—Å—Ç—É–ø–æ–≤ */
}

.modal-content label {
    margin-bottom: 4px; /* –£–º–µ–Ω—å—à–µ–Ω–∏–µ –æ—Ç—Å—Ç—É–ø–æ–≤ */
    font-weight: bold;
    color: #dd362f; /* rgb(221, 54, 47) */
}

.modal-content input, .modal-content select, .modal-content textarea, .modal-content button {
    display: block;
    width: 100%;
    padding: 8px; /* –£–º–µ–Ω—å—à–µ–Ω–∏–µ –æ—Ç—Å—Ç—É–ø–æ–≤ */
    margin-bottom: 8px; /* –£–º–µ–Ω—å—à–µ–Ω–∏–µ –æ—Ç—Å—Ç—É–ø–æ–≤ */
    border-radius: 5px;
    border: 1px solid #ddd;
    font-size: 12px; /* –£–º–µ–Ω—å—à–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ —à—Ä–∏—Ñ—Ç–∞ */
}

.modal-content button.btn-primary {
    background-color: #dd362f; /* rgb(221, 54, 47) */
    border: none;
    color: #fff;
}

.modal-content button.btn-primary:hover {
    background-color: #fca711; /* rgb(252, 167, 17) */
}

.modal-content button.btn-secondary {
    background-color: #f4f4f9;
    border: 1px solid #ddd;
    color: #000;
}

.modal-content button.btn-secondary:hover {
    background-color: #ddd;
}

.dropdown-content a {
    color: black;
    padding: 12px 16px;
    text-decoration: none;
    display: block;
}

.dropdown-content a:hover {
    background-color: #f1f1f1;
}

#zoom-controls {
    position: absolute;
    bottom: 150px;
    right: 50px;
    z-index: 2;
}

#zoom-controls div {
    margin-bottom: 10px;
}

.centered-form {
    width: 90%; /* –£–º–µ–Ω—å—à–µ–Ω–∏–µ —à–∏—Ä–∏–Ω—ã –¥–æ 90% */
    max-width: 400px; /* –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —à–∏—Ä–∏–Ω–∞ —Ñ–æ—Ä–º—ã */
    font-size: 14px;
}

# End of code from /Users/nickstanchenkov/donde_empanada4/donde_empanada4/app/static/styles.css

# Code from /Users/nickstanchenkov/donde_empanada4/donde_empanada4/app/templates/index.html
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Map Application</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    <meta name="language" content="ru">
</head>

<body>
    <div class="header">
        <img src="{{ url_for('static', filename='logo.png') }}" alt="Logo" onclick="location.reload()">
        {% if current_user.is_authenticated %}
        <div class="dropdown">
            <img src="{{ url_for('static', filename='profile.png') }}" alt="Profile" class="dropdown-toggle" id="profileDropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <div class="dropdown-menu" aria-labelledby="profileDropdown">
                <a class="dropdown-item" href="#">–ê–∫–∫–∞—É–Ω—Ç</a>
                <a class="dropdown-item" href="#">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</a>
                <a class="dropdown-item" href="{{ url_for('main.logout') }}">–í—ã–π—Ç–∏</a>
            </div>
        </div>
        {% else %}
        <div class="login-button" onclick="document.getElementById('login-modal').style.display='block'">–í–æ–π—Ç–∏</div>
        {% endif %}
    </div>
    <div id="map"></div>
    {% if current_user.is_authenticated %}
    <div class="custom-button-right" id="add-marker" onclick="promptLocationSelection()">
        <img src="{{ url_for('static', filename='add.png') }}" alt="Add Marker">
    </div>
    {% endif %}
    <div class="custom-button-right" id="my-location" style="margin-top: 170px !important;" onclick="locateMe()">
        <img src="{{ url_for('static', filename='location.png') }}" alt="My Location">
    </div>
    <div class="custom-button-right" id="zoom-controls" style="top: 350px !important;">
        <div onclick="zoomIn()">
            <img src="{{ url_for('static', filename='zoom_in.png') }}" alt="Zoom In">
        </div>
        <div onclick="zoomOut()">
            <img src="{{ url_for('static', filename='zoom_out.png') }}" alt="Zoom Out">
        </div>
    </div>

    <!-- Login Modal -->
    <div id="login-modal" class="modal">
        <div class="modal-content centered-form">
            <form id="login-form" action="{{ url_for('main.login') }}" method="post" onsubmit="handleLogin(event)">
                {{ login_form.hidden_tag() }}
                {{ login_form.csrf_token }}
                <div class="form-group">
                    <label for="username">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</label>
                    <input type="text" class="form-control" name="username" placeholder="–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è" required>
                </div>
                <div class="form-group">
                    <label for="password">–ü–∞—Ä–æ–ª—å</label>
                    <input type="password" class="form-control" name="password" placeholder="–ü–∞—Ä–æ–ª—å" required>
                </div>
                <button type="submit" class="btn btn-primary">–í–æ–π—Ç–∏</button>
                <button type="button" class="btn btn-secondary" onclick="closeLoginForm()">–û—Ç–º–µ–Ω–∞</button>
                <div class="link" onclick="showRegistrationForm()">–ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞?</div>
            </form>
        </div>
    </div>

    <!-- Registration Modal -->
    <div id="registration-modal" class="modal">
        <div class="modal-content centered-form">
            <form id="registration-form" action="{{ url_for('main.register') }}" method="post" onsubmit="handleRegistration(event)">
                {{ registration_form.hidden_tag() }}
                {{ registration_form.csrf_token }}
                <div class="form-group">
                    <label for="username">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</label>
                    <input type="text" class="form-control" name="username" placeholder="–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è" required>
                </div>
                <div class="form-group">
                    <label for="first_name">–ò–º—è</label>
                    <input type="text" class="form-control" name="first_name" placeholder="–ò–º—è" required>
                </div>
                <div class="form-group">
                    <label for="second_name">–§–∞–º–∏–ª–∏—è</label>
                    <input type="text" class="form-control" name="second_name" placeholder="–§–∞–º–∏–ª–∏—è" required>
                </div>
                <div class="form-group">
                    <label for="email">–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è –ø–æ—á—Ç–∞</label>
                    <input type="email" class="form-control" name="email" placeholder="–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è –ø–æ—á—Ç–∞" required>
                </div>
                <div class="form-group">
                    <label for="phone">–¢–µ–ª–µ—Ñ–æ–Ω</label>
                    <input type="text" class="form-control" name="phone" placeholder="–¢–µ–ª–µ—Ñ–æ–Ω" required>
                </div>
                <div class="form-group">
                    <label for="password">–ü–∞—Ä–æ–ª—å</label>
                    <input type="password" class="form-control" name="password" placeholder="–ü–∞—Ä–æ–ª—å" required>
                </div>
                <div class="form-group">
                    <label for="confirm_password">–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–∞—Ä–æ–ª—å</label>
                    <input type="password" class="form-control" name="confirm_password" placeholder="–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–∞—Ä–æ–ª—å" required>
                </div>
                <button type="submit" class="btn btn-primary">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
                <button type="button" class="btn btn-secondary" onclick="closeRegistrationForm()">–û—Ç–º–µ–Ω–∞</button>
            </form>
        </div>
    </div>

    <!-- Add Marker Modal -->
    <div id="add-marker-modal" class="modal">
        <div class="modal-content centered-form">
            <form id="add-marker-form" action="{{ url_for('main.add_location') }}" method="post" onsubmit="handleAddLocation(event)">
                {{ location_form.hidden_tag() }}
                {{ location_form.csrf_token }}
                <div class="form-group">
                    <label for="name">–ù–∞–∑–≤–∞–Ω–∏–µ</label>
                    <input type="text" class="form-control" name="name" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ (–Ω–µ –±–æ–ª–µ–µ 30 —Å–∏–º–≤–æ–ª–æ–≤)" maxlength="30" required>
                </div>
                <div class="form-group">
                    <label for="address">–ê–¥—Ä–µ—Å</label>
                    <input type="text" class="form-control" name="address" placeholder="–ê–¥—Ä–µ—Å (–¥–æ 150 —Å–∏–º–≤–æ–ª–æ–≤)" maxlength="150">
                </div>
                <div class="form-group">
                    <label for="average_check">–¶–µ–Ω–∞ –∑–∞ —ç–º–ø–∞–Ω–∞–¥–æ—Å</label>
                    <input type="number" class="form-control" name="average_check" placeholder="–¶–µ–Ω–∞ (2000 - 5000)" min="2000" max="5000" required>
                </div>
                <div class="form-group">
                    <label for="working_hours">–ß–∞—Å—ã —Ä–∞–±–æ—Ç—ã</label>
                    <input type="text" class="form-control" name="working_hours" placeholder="–ß–∞—Å—ã —Ä–∞–±–æ—Ç—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, 9:00 - 18:00)" required>
                </div>
                <button type="submit" class="btn btn-primary">–î–æ–±–∞–≤–∏—Ç—å</button>
                <button type="button" class="btn btn-secondary" onclick="closeAddMarkerForm()">–û—Ç–º–µ–Ω–∞</button>
                <button type="button" class="btn btn-info" onclick="document.getElementById('owner-info-modal').style.display='block'">–Ø —Ö–æ–∑—è–∏–Ω</button>
            </form>
        </div>
    </div>

    <!-- Owner Info Modal -->
    <div id="owner-info-modal" class="modal">
        <div class="modal-content centered-form">
            <form id="owner-info-form" action="{{ url_for('main.add_owner_info') }}" method="post" onsubmit="handleOwnerInfoSubmit(event)">
                {{ owner_info_form.hidden_tag() }}
                {{ owner_info_form.csrf_token }}
                <div class="form-group">
                    <label for="website">–í–µ–±-—Å–∞–π—Ç</label>
                    <input type="url" class="form-control" name="website" placeholder="URL —Å–∞–π—Ç–∞ (–¥–æ 200 —Å–∏–º–≤–æ–ª–æ–≤)" maxlength="200">
                </div>
                <div class="form-group">
                    <label for="owner_info">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤–∞—Å –∏ –≤–∞—à–µ–º –∑–∞–≤–µ–¥–µ–Ω–∏–∏</label>
                    <textarea name="owner_info" class="form-control" rows="4" required></textarea>
                </div>
                <input type="hidden" name="location_id" id="location_id">
                <button type="submit" class="btn btn-primary">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                <button type="button" class="btn btn-secondary" onclick="closeOwnerInfoForm()">–û—Ç–º–µ–Ω–∞</button>
            </form>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
    <script src="{{ url_for('static', filename='script.js') }}"></script>
    <script async src="https://maps.googleapis.com/maps/api/js?key={{ google_maps_api_key }}&callback=initMap"></script>
</body>

</html>

# End of code from /Users/nickstanchenkov/donde_empanada4/donde_empanada4/app/templates/index.html

# Code from /Users/nickstanchenkov/donde_empanada4/donde_empanada4/app/templates/register.html
{% extends 'base.html' %}

{% block title %}–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è{% endblock %}

{% block content %}
<div class="d-flex justify-content-center align-items-center" style="height: 80vh;">
    <form method="post" id="registerForm">
        {{ form.hidden_tag() }}
        <div class="mb-3">
            {{ form.username.label(class="form-label") }}
            {{ form.username(class="form-control") }}
            {% if form.username.errors %}
                <div class="alert alert-danger" role="alert">
                    {{ form.username.errors[0] }} üõë
                </div>
            {% endif %}
        </div>
        <div class="mb-3">
            {{ form.email.label(class="form-label") }}
            {{ form.email(class="form-control") }}
            {% if form.email.errors %}
                <div class="alert alert-danger" role="alert">
                    {{ form.email.errors[0] }} üõë
                </div>
            {% endif %}
        </div>
        <div class="mb-3">
            {{ form.password.label(class="form-label") }}
            {{ form.password(class="form-control") }}
            {% if form.password.errors %}
                <div class="alert alert-danger" role="alert">
                    {{ form.password.errors[0] }} üõë
                </div>
            {% endif %}
        </div>
        <div class="mb-3">
            {{ form.confirm_password.label(class="form-label") }}
            {{ form.confirm_password(class="form-control") }}
            {% if form.confirm_password.errors %}
                <div class="alert alert-danger" role="alert">
                    {{ form.confirm_password.errors[0] }} üõë
                </div>
            {% endif %}
        </div>
        <div class="mb-3">
            {{ form.first_name.label(class="form-label") }}
            {{ form.first_name(class="form-control") }}
            {% if form.first_name.errors %}
                <div class="alert alert-danger" role="alert">
                    {{ form.first_name.errors[0] }} üõë
                </div>
            {% endif %}
        </div>
        <div class="mb-3">
            {{ form.second_name.label(class="form-label") }}
            {{ form.second_name(class="form-control") }}
            {% if form.second_name.errors %}
                <div class="alert alert-danger" role="alert">
                    {{ form.second_name.errors[0] }} üõë
                </div>
            {% endif %}
        </div>
        <div class="mb-3">
            {{ form.phone.label(class="form-label") }}
            {{ form.phone(class="form-control") }}
            {% if form.phone.errors %}
                <div class="alert alert-danger" role="alert">
                    {{ form.phone.errors[0] }} üõë
                </div>
            {% endif %}
        </div>
        <div class="mb-3">
            {{ form.submit(class="btn btn-primary") }}
        </div>
    </form>
</div>
{% endblock %}

# End of code from /Users/nickstanchenkov/donde_empanada4/donde_empanada4/app/templates/register.html

# Code from /Users/nickstanchenkov/donde_empanada4/donde_empanada4/app/templates/page404.html
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–°—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; padding: 50px; }
        h1 { font-size: 48px; color: #333; }
        p { font-size: 24px; color: #666; }
        a { font-size: 24px; color: #007BFF; text-decoration: none; }
        a:hover { text-decoration: underline; }
    </style>
</head>
<body>
    <h1>–û–π! –°—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞.</h1>
    <p>–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º–∞—è –≤–∞–º–∏ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–∞–π–¥–µ–Ω–∞. –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏–∑-–∑–∞ –æ—à–∏–±–∫–∏ –≤ –∞–¥—Ä–µ—Å–µ –∏–ª–∏ –ø–æ—Ç–æ–º—É —á—Ç–æ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –±—ã–ª–∞ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∞ –∏–ª–∏ —É–¥–∞–ª–µ–Ω–∞.</p>
    <p><a href="/">–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É</a></p>
</body>
</html>

# End of code from /Users/nickstanchenkov/donde_empanada4/donde_empanada4/app/templates/page404.html
